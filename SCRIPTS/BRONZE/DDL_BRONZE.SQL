/*
=======================================================
DDL: CREATE BRONZE TABLES
=======================================================
THIS SCRIPT CREATES TABLES IN THE 'BRONZE' SCHEMA, DROPPING EXISTING TABLES IF THEY EXISTS.
*/


IF OBJECT_ID('BRONZE.CRM_CUST_INFO', 'U') IS NOT NULL
     DROP TABLE BRONZE.CRM_CUST_INFO;
CREATE TABLE BRONZE.CRM_CUST_INFO
(
    CST_ID              INT,
    CST_KEY             NVARCHAR(50),
    CST_FIRSTNAME       NVARCHAR(100),
    CST_LASTNAME        NVARCHAR(100),
    CST_MARITAL_STATUS  NVARCHAR(50),
    CST_GNDR            NVARCHAR(50),
    CST_CREATE_DATE     DATE
);


IF OBJECT_ID('BRONZE.CRM_PROD_INFO', 'U') IS NOT NULL
     DROP TABLE BRONZE.CRM_PROD_INFO;
CREATE TABLE BRONZE.CRM_PROD_INFO
(
    PRD_ID         INT,
    PRD_KEY        VARCHAR(50),
    PRD_NM         VARCHAR(150),
    PRD_COST       DECIMAL(10,2),
    PRD_LINE       VARCHAR(50),
    PRD_START_DT  DATE,
    PRD_END_DT    DATE
);

IF OBJECT_ID('BRONZE.CRM_SALES_DETAILS', 'U') IS NOT NULL
     DROP TABLE BRONZE.CRM_SALES_DETAILS;
CREATE TABLE bronze.CRM_SALES_DETAILS
(
    SLS_ORD_NUM    VARCHAR(50),
    SLS_PRD_KEY    VARCHAR(50),
    SLS_CUST_ID    INT,
    SLS_ORDER_DT   DATE,
    SLS_SHIP_DT    DATE,
    SLS_DUE_DT     DATE,
    SLS_SALES      DECIMAL(12,2),
    SLS_QUANTITY   INT,
    SLS_PRICE      DECIMAL(10,2)
);

IF OBJECT_ID('BRONZE.ERP_CUST_AZ12', 'U') IS NOT NULL
     DROP TABLE BRONZE.ERP_CUST_AZ12;
CREATE TABLE bronze.ERP_CUST_AZ12
(
    CID             NVARCHAR(50),
    BDATE           DATE,
    GEN             VARCHAR(10)
);

IF OBJECT_ID('BRONZE.ERP_LOC_A101', 'U') IS NOT NULL
     DROP TABLE BRONZE.ERP_LOC_A101;
CREATE TABLE bronze.ERP_LOC_A101
(
    CID             NVARCHAR(50),
    CNTRY           VARCHAR(50)
);

IF OBJECT_ID('BRONZE.ERP_PX_CAT_G1V2', 'U') IS NOT NULL
     DROP TABLE BRONZE.ERP_PX_CAT_G1V2;
CREATE TABLE bronze.ERP_PX_CAT_G1V2
(
    ID              NVARCHAR(50),
    CAT             VARCHAR(100),
    SUBCAT          VARCHAR(100),
    MAINTENANCE     VARCHAR(50)
);
